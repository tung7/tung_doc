<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title data-th-text="${config[title]}">Tung Doc</title>
    <link rel="stylesheet" type="text/css" href="/assets/css/semantic.min.css">
    <script type="text/javascript" src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="assets/js/semantic.min.js"></script>
</head>
<body class="index">
<!-- personel css/js start -->
<style type="text/css">
    .index .ui.card.category {
        color: #000;
    }
    .index .ui.card.category>.header{
        font-weight: 700;
        font-size: 1.2857em;
        padding: .6em;
        line-height: 1.2857em;
    }
    .index .ui.card.category .description.content{
        min-height:150px;
    }
    .index .group .cards {
        margin-top: 1em;
    }
    .index .group .title {
        margin-top: 4em;
    }
    .index .group .cards  .add-top-category {
        height: 100%;font-size: 5em;color: #fff;
    }

    .hidden.menu {
        display: none;
    }
    .masthead.segment {
        min-height: 500px;
        padding: 1em 0;
    }
    .masthead .logo.item img {
        margin-right: 1em;
    }
    .masthead .ui.menu .ui.button {
        margin-left: 0.5em;
    }
    .masthead h1.ui.header {
        margin-top: 1.5em;
        margin-bottom: 0;
        font-size: 4em;
        font-weight: normal;
    }
    .masthead h2 {
        font-size: 1.7em;
        font-weight: normal;
    }
    .ui.vertical.stripe h3 {
        font-size: 2em;
    }
    .ui.vertical.stripe .button + h3,
    .ui.vertical.stripe p + h3 {
        margin-top: 3em;
    }
    .ui.vertical.stripe .floated.image {
        clear: both;
    }
    .ui.vertical.stripe p {
        font-size: 1.33em;
    }
    .ui.vertical.stripe .horizontal.divider {
        margin: 3em 0;
    }
    .quote.stripe.segment {
        padding: 0;
    }
    .quote.stripe.segment .grid .column {
        padding-top: 5em;
        padding-bottom: 5em;
    }
    .footer.segment {
        padding: 5em 0em;
    }
    .secondary.pointing.menu .toc.item {
        display: none;
    }
    @media only screen and (max-width: 700px) {
        .ui.fixed.menu {
            display: none !important;
        }
        .secondary.pointing.menu .item,
        .secondary.pointing.menu .menu {
            display: none;
        }
        .secondary.pointing.menu .toc.item {
            display: block;
        }
        .masthead.segment {
            min-height: 350px;
        }
        .masthead h1.ui.header {
            font-size: 2em;
            margin-top: 1.5em;
        }
        .masthead h2 {
            margin-top: 0.5em;
            font-size: 1.5em;
        }
    }
</style>
<script>
    $(document).ready(function() {
        // fix menu when passed
        $('.masthead').visibility({
            once: false,
            onBottomPassed: function() {
                $('.fixed.menu').transition('fade in');
            },
            onBottomPassedReverse: function() {
                $('.fixed.menu').transition('fade out');
            }
        });

        // create sidebar and attach to menu open
        $('.ui.sidebar').sidebar('attach events', '.toc.item');
    });
</script>
<!-- personel css/js end -->

<!-- Following Menu -->
<div class="ui large top fixed hidden menu">
  <div class="ui container">
    <a class="active item" >Home</a>
    <a class="item">Work</a>
    <a class="item">Company</a>
    <a class="item">Careers</a>
    <div class="right menu">
      <div class="item">
        <a class="ui button"  href="/login">Log in</a>
      </div>
    </div>
  </div>
</div>

<!-- Sidebar Menu -->
<div class="ui vertical inverted sidebar menu">
  <a class="active item" >Home</a>
  <a class="item">Work</a>
  <a class="item">Company</a>
  <a class="item">Careers</a>
  <a class="item" href="/login">Login</a>
</div>


<!-- Page Contents -->
<div class="pusher">
  <!-- screen start -->
  <div class="ui inverted vertical masthead center aligned segment" >
    <!-- screen-nav start -->
    <div class="ui container">
      <div class="ui large secondary inverted pointing menu">
        <a class="toc item">
          <i class="sidebar icon"></i>
        </a>
        <a class="active item">Home</a>
        <a class="item">Work</a>
        <a class="item">Company</a>
        <a class="item">Careers</a>
        <div class="right item">
          <a class="ui inverted button"  href="/login">Log in</a>
        </div>
      </div>
    </div>
    <!-- screen-nav end -->
    <div class="ui text container">
      <h1 class="ui inverted header" data-th-text="${config[slogan_title]}">
        Tung Docs
      </h1>
      <h2 data-th-text="${config[slogan_content]}">Do whatever you want when you want to.</h2>
      <!--<div class="ui huge primary button">Get Started <i class="right arrow icon"></i></div>-->
    </div>
  </div>
  <!-- screen end -->

  <!-- categories start -->
    <div class="ui vertical stripe container" style="min-height: 400px;margin-bottom: 50px;">
        <div class="group" data-th-each="group : ${groups}">
            <div class="ui row title"><h2 class="ui header" data-th-text="${group.name}">Front-End Tech.</h2></div>
            <div class="ui divider"></div>

            <div class="ui row three container cards">
                <a class="ui card category" data-th-each="category : ${group.topCategories}" data-th-href="${'/category/'+category.id}">
                    <div class="header" data-th-text="${category.name}">Linux</div>
                    <div class="description content" data-th-text="${category.description}">
                        Elliot Fu is a film-maker from New York. Elliot Fu is a film-maker from New Yo Elliot Fu is a film-maker from New Yo Elliot Fu is a film-maker from New Yos
                    </div>
                    <div class="extra content" >
                        <span style=""><i class="file text outline icon"></i><span data-th-text="${category.articleNum}">121</span> Pages</span>
                    </div>
                </a>
                <a class="ui card category">
                    <button class="ui icon button add-top-category" data-th-data-group-id="${group.id}">
                        <i class="plus icon"></i>
                    </button>
                </a>
            </div>
        </div>
    </div>
  <!-- categories end -->

  <!-- footer start -->
  <div class="ui inverted vertical footer segment">
    <div class="ui container">
      <div class="colophon" id="colophon" data-th-text="${config[colophon]}"></div>
    </div>
  </div>
  <!-- footer end -->

</div>
<!-- Page Contents end -->

<!-- modal  -->
<div class="ui long modal add-category-modal">
    <i class="close icon"></i>
    <div class="header">
        新增类别
    </div>
    <div class="content">
            <div class="ui equal width form">
                <div class="field">
                    <input type="hidden" name="group_id" >
                </div>
                <div class="field">
                    <label>类别名</label>
                    <input type="text" name="name" >
                </div>
                <!--<div class="field">-->
                    <!--<label>序号</label>-->
                    <!--<input type="number" name="taxis" >-->
                <!--</div>-->
                <div class="field">
                    <label>描述</label>
                    <textarea  name="description" placeholder="给类别加点描述..."></textarea>
                </div>
            </div>
    </div>
    <div class="actions">
        <div class="ui black deny button">取消</div>
        <div class="ui positive right labeled icon button">
            保存<i class="checkmark icon"></i>
        </div>
    </div>
    <div class="ui dimmer">
        <div class="ui text loader">Loading</div>
    </div>
</div>
<!-- modal  end -->
<script>
$(function(){
    var $addTopCategoryModal = $('.add-category-modal');
    var $addTopCategoryBtn = $('.add-top-category');
    var addTopCategoryUrl = '/api/admin/category/save';

    $addTopCategoryBtn.on("click", function() {
        $addTopCategoryModal.find('input[name=group_id]').val($(this).attr('data-group-id'));
        $addTopCategoryModal.modal('setting', {
            transition : 'fade up',
            closable : false,
            onDeny : function(){
                clearAddCategoryModal();
            },
            onApprove : function() {
                saveTopCategory(this);
            },
            onHide: function () {
                clearAddCategoryModal();
            }
        }).modal('show');
    });

    $addTopCategoryModal.find('input[name=name]').on('blur', function () {

    });

    function clearAddCategoryModal() {
        $addTopCategoryModal.find('input').val('');
        $addTopCategoryModal.find('textarea').val('');
        $addTopCategoryModal.find('.ui.dimmer').removeClass('active');
    }

    function activeDimmer($dimmer) {
        $dimmer.addClass('active');
    }

    function clearDimmer($dimmer) {
        $dimmer.removeClass('active');
    }

    function saveTopCategory(context) {
        var $form = $addTopCategoryModal.find('.form');
        var $groupId = $form.find('input[name=group_id]');
        var $name = $form.find('input[name=name]');
//        var $taxis = $form.find('input[name=taxis]');
        var $description = $form.find('textarea[name=description]');

        $.ajax({
            type: 'POST',
            url: addTopCategoryUrl,
            data: {
                'group.id': $groupId.val(),
                'name': $name.val(),
//                'taxis': $taxis.val(),
                'description': $description.val()
            },
            beforeSend: function () {
                activeDimmer($addTopCategoryModal.find('.ui.dimmer'));
            },
            success: function (d) {
                console.log(d)
                if (d.success) {
                    $(context).dimmer('hide');
                    window.location.reload();
                }

            },
            complete: function (d) {

            }
        });
    }
})
</script>

</body>

</html>
